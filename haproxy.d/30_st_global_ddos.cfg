backend st_global_ddos
    # Stick Table Definitions
    #  - conn_cur: count active connections
    #  - conn_rate(10s): average incoming connection rate over 10 seconds
    #  - http_err_rate(3s): Monitors the number of errors generated by an IP over a period of 3 seconds
    #  - http_req_rate(10s): Monitors the number of request sent by an IP over a period of 10 seconds
    stick-table type ipv6 size 2m expire 30s store conn_cur,conn_rate(10s),http_req_rate(10s),http_err_rate(3s)

# Cache DNSBL requests
backend st_known_tor_visitors
    # Store the IP address of the client after DNSBL lookup
    #
    # gpc0 > 0 means the IP address is not blacklisted
    # gpc1 > 0 means the IP address is blacklisted
    #
    # Information is stored for 30 minutes
    stick-table type ipv6 size 2m expire 30m store gpc0,gpc1

backend st_tor_request_rate
    stick-table type string len 32 size 10 expire 24h store conn_cur,conn_rate(10s),http_req_rate(10s),http_err_rate(10s)

backend st_tor_24h_ban
    stick-table type ipv6 size 1m expire 24h store gpc0

backend st_tor_24days_ban
    stick-table type ipv6 size 1m expire 24d store gpc0

